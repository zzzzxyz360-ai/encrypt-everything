<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A.I. CRYPTO LINK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-purple: #bc13fe;
            --bg-dark: #050505;
            --glass: rgba(12, 12, 12, 0.95);
        }

        body {
            background-color: var(--bg-dark);
            color: var(--neon-blue);
            font-family: 'Share Tech Mono', monospace;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .font-header { font-family: 'Orbitron', sans-serif; }

        #neural-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; pointer-events: none; opacity: 0.4;
        }

        .glass-panel {
            background: var(--glass);
            border: 1px solid rgba(0, 243, 255, 0.3);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.1);
        }

        .tech-border { position: relative; }
        .tech-border::before, .tech-border::after {
            content: ''; position: absolute; width: 15px; height: 15px;
            border: 2px solid var(--neon-blue); transition: all 0.3s ease;
        }
        .tech-border::before { top: -1px; left: -1px; border-right: 0; border-bottom: 0; }
        .tech-border::after { bottom: -1px; right: -1px; border-left: 0; border-top: 0; }

        .cyber-input {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #333;
            color: white;
            font-family: 'Share Tech Mono', monospace;
            -webkit-appearance: none;
            border-radius: 6px;
        }
        .cyber-input:focus { outline: none; border-color: var(--neon-blue); }

        .mode-switch {
            cursor: pointer; transition: 0.2s; opacity: 0.5;
            border-bottom: 3px solid transparent;
        }
        .mode-switch.active {
            opacity: 1; border-color: var(--neon-blue);
            background: rgba(0, 243, 255, 0.08);
        }

        /* Optimized Scanline */
        .scanline {
            position: absolute; top: 0; left: 0; width: 100%; height: 4px;
            background: var(--neon-blue); opacity: 0.1;
            animation: scanline 4s linear infinite; pointer-events: none;
            will-change: transform;
        }
        @keyframes scanline { 0% { transform: translateY(-100%); } 100% { transform: translateY(600px); } }

        input, textarea { font-size: 16px !important; } /* No Zoom on Mobile */
    </style>
</head>
<body class="min-h-screen flex items-center justify-center relative selection:bg-cyan-500 selection:text-black">

    <canvas id="neural-canvas"></canvas>

    <main class="relative z-10 w-full max-w-md p-3 animate-fade-in-up">
        
        <!-- Header -->
        <div class="flex justify-between items-end mb-3 px-2">
            <div>
                <h1 class="text-3xl font-header font-black tracking-widest text-white">SECURE<span class="text-cyan-400">_LINK</span></h1>
                <div class="text-[10px] text-cyan-700 tracking-[0.2em] font-bold">V4.0 // FINAL_OPTIMIZED</div>
            </div>
            <button onclick="toggleSettings()" class="text-cyan-600 hover:text-cyan-400 transition p-2">
                <i class="fa-solid fa-gear text-xl"></i>
            </button>
        </div>

        <div class="glass-panel rounded-xl p-1 relative overflow-hidden tech-border">
            <div class="scanline"></div>

            <!-- Tabs -->
            <div class="flex bg-black/60 rounded-t-lg mb-1 border-b border-gray-800">
                <div onclick="setMode('encrypt')" id="tab-enc" class="mode-switch active flex-1 py-4 text-center font-bold text-lg uppercase tracking-wider text-cyan-400">
                    <i class="fa-solid fa-lock mr-2"></i> Encrypt
                </div>
                <div onclick="setMode('decrypt')" id="tab-dec" class="mode-switch flex-1 py-4 text-center font-bold text-lg uppercase tracking-wider text-purple-400">
                    <i class="fa-solid fa-unlock mr-2"></i> Decrypt
                </div>
            </div>

            <div class="p-4">

                <!-- ENCRYPT VIEW -->
                <div id="view-encrypt" class="flex flex-col space-y-4">
                    
                    <!-- Message Area with PASTE -->
                    <div class="relative group">
                        <label class="text-xs text-cyan-600 mb-1 block uppercase font-bold flex justify-between items-center">
                            <span>1. Message</span>
                            <button onclick="pasteToInput('encMsg')" class="text-[10px] bg-cyan-900/50 px-3 py-1 rounded border border-cyan-700 text-cyan-300 hover:bg-cyan-800 active:scale-95 transition">
                                <i class="fa-solid fa-clipboard mr-1"></i> PASTE
                            </button>
                        </label>
                        <textarea id="encMsg" rows="3" class="cyber-input w-full p-3 text-sm resize-none" placeholder="Type secret message..."></textarea>
                    </div>

                    <!-- Password Area -->
                    <div>
                        <div class="flex justify-between items-center mb-1">
                            <label class="text-xs text-cyan-600 uppercase font-bold">2. Password</label>
                            <span id="key-status" class="text-[10px] text-gray-500 font-bold">NOT SAVED</span>
                        </div>
                        <input type="password" id="encPass" class="cyber-input w-full p-3 text-sm tracking-widest" placeholder="Enter Key">
                    </div>

                    <button onclick="processEncrypt()" class="w-full bg-cyan-700 hover:bg-cyan-600 active:bg-cyan-500 text-white font-header font-black py-4 rounded text-xl shadow-lg uppercase transition-colors">
                        Encrypt Now
                    </button>

                    <!-- Output Area -->
                    <div id="encOutputBox" class="hidden animate-pulse-once">
                        <label class="text-xs text-green-400 mb-1 block uppercase font-bold">Result:</label>
                        <div id="encResult" class="bg-black border border-green-500 p-3 text-xs break-all text-green-500 font-mono h-24 overflow-y-auto rounded mb-2"></div>
                        <button onclick="manualCopy()" id="copyBtn" class="w-full bg-green-900/40 border border-green-500 text-green-400 py-3 rounded hover:bg-green-800/60 font-bold text-sm uppercase flex items-center justify-center gap-2 transition-all">
                            <i class="fa-solid fa-copy"></i> Copy Result
                        </button>
                    </div>
                </div>

                <!-- DECRYPT VIEW -->
                <div id="view-decrypt" class="hidden flex flex-col space-y-4">
                    
                    <!-- Password Area -->
                    <div>
                        <label class="text-xs text-purple-400 uppercase font-bold mb-1 block">1. Password</label>
                        <input type="password" id="decPass" class="cyber-input w-full p-3 text-sm tracking-widest border-purple-900 focus:border-purple-500" placeholder="Enter Key">
                    </div>

                    <!-- Input Area with PASTE -->
                    <div>
                        <label class="text-xs text-purple-400 uppercase font-bold mb-1 block flex justify-between items-center">
                            <span>2. Paste Emojis</span>
                            <button onclick="pasteToInput('decInput')" class="text-[10px] bg-purple-900/50 px-3 py-1 rounded border border-purple-700 text-purple-300 hover:bg-purple-800 active:scale-95 transition">
                                <i class="fa-solid fa-clipboard mr-1"></i> PASTE
                            </button>
                        </label>
                        <textarea id="decInput" rows="3" class="cyber-input w-full p-3 text-xs resize-none border-gray-700 focus:border-purple-500" placeholder="Paste the emojis here..."></textarea>
                    </div>

                    <button onclick="processDecrypt()" class="w-full bg-purple-700 hover:bg-purple-600 active:bg-purple-500 text-white font-header font-black py-4 rounded text-xl shadow-lg uppercase transition-colors">
                        Decrypt Message
                    </button>

                    <!-- Result Area -->
                    <div id="decResultBox" class="hidden mt-2">
                        <label class="text-xs text-cyan-400 mb-1 block uppercase font-bold">DECRYPTED MESSAGE:</label>
                        <div class="bg-black border-2 border-cyan-400 p-4 rounded shadow-[0_0_15px_rgba(0,243,255,0.2)] min-h-[60px]">
                            <p id="decText" class="text-cyan-300 font-bold text-base leading-relaxed break-words"></p>
                        </div>
                    </div>
                </div>

            </div>
            
            <!-- Footer -->
            <div class="bg-black/80 p-3 flex justify-between items-center text-[10px] text-gray-600 border-t border-gray-800 font-bold">
                <span>SYSTEM: <span class="text-green-600">ONLINE</span></span>
                <span>SECURE_V4</span>
            </div>
        </div>
    </main>

    <!-- SETTINGS MODAL -->
    <div id="settings-modal" class="fixed inset-0 bg-black/90 z-50 hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-gray-900 border border-cyan-700 p-6 rounded-xl w-full max-w-sm shadow-2xl relative">
            <button onclick="toggleSettings()" class="absolute top-4 right-4 text-gray-400 hover:text-white p-2"><i class="fa-solid fa-xmark text-xl"></i></button>
            <h2 class="text-xl font-header text-white mb-6 border-b border-gray-700 pb-2">SETTINGS</h2>
            <div class="space-y-6">
                <div>
                    <label class="text-xs text-cyan-500 font-bold uppercase block mb-2">Default Password</label>
                    <div class="flex space-x-2">
                        <input type="text" id="setting-key" class="cyber-input flex-1 p-2 rounded text-sm" placeholder="Your Password">
                        <button onclick="saveDefaultKey()" class="bg-cyan-700 text-white px-4 rounded text-xs font-bold uppercase hover:bg-cyan-600">Save</button>
                    </div>
                </div>
                <div class="pt-4 border-t border-gray-800">
                    <button onclick="clearData()" class="w-full border border-red-900 text-red-500 py-3 rounded hover:bg-red-900/20 text-xs font-bold uppercase flex items-center justify-center gap-2">
                        <i class="fa-solid fa-trash"></i> Reset Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed top-5 left-1/2 -translate-x-1/2 bg-gray-900 border border-cyan-500 text-cyan-400 px-5 py-3 rounded shadow-lg z-[60] opacity-0 pointer-events-none transition-all duration-300 flex items-center gap-3 w-max max-w-[90%]">
        <i class="fa-solid fa-circle-check"></i>
        <span id="toastMsg" class="font-bold tracking-wider text-xs">READY</span>
    </div>

    <script>
        // --- 1. OPTIMIZED PARTICLES (Max 30) ---
        var canvas = document.getElementById('neural-canvas');
        var ctx = canvas.getContext('2d');
        var width, height;
        var particles = [];
        var particleCount = 30; // Strictly limited for performance
        var connectionDist = 120;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        function Particle() {
            this.x = Math.random() * width;
            this.y = Math.random() * height;
            this.vx = (Math.random() - 0.5) * 0.4;
            this.vy = (Math.random() - 0.5) * 0.4;
            this.size = Math.random() * 2 + 1;
        }
        
        Particle.prototype.update = function() {
            this.x += this.vx; this.y += this.vy;
            if(this.x < 0 || this.x > width) this.vx *= -1;
            if(this.y < 0 || this.y > height) this.vy *= -1;
        };
        
        Particle.prototype.draw = function() {
            ctx.fillStyle = '#00f3ff';
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fill();
        };

        for(var i=0; i<particleCount; i++) particles.push(new Particle());

        function animate() {
            ctx.clearRect(0, 0, width, height);
            ctx.strokeStyle = 'rgba(0, 243, 255, 0.1)';
            ctx.lineWidth = 0.5;
            
            for(var i=0; i<particles.length; i++) {
                var p1 = particles[i];
                p1.update(); p1.draw();
                for(var j=i+1; j<particles.length; j++) {
                    var p2 = particles[j];
                    var dx = p1.x - p2.x; var dy = p1.y - p2.y;
                    var dist = Math.sqrt(dx*dx + dy*dy);
                    if(dist < connectionDist) {
                        ctx.beginPath(); ctx.moveTo(p1.x, p1.y); ctx.lineTo(p2.x, p2.y); ctx.stroke();
                    }
                }
            }
            requestAnimationFrame(animate);
        }
        animate();

        // --- 2. LOGIC ---
        
        // PASTE FUNCTION (Optimized for failures)
        async function pasteToInput(id) {
            const input = document.getElementById(id);
            input.focus();
            
            if (navigator.clipboard && navigator.clipboard.readText) {
                try {
                    const text = await navigator.clipboard.readText();
                    input.value = text;
                    showToast("PASTED!");
                } catch (err) {
                    showToast("TAP BOX TO PASTE", true);
                }
            } else {
                showToast("TAP BOX TO PASTE", true);
            }
        }

        // Copy Function
        function manualCopy() {
            var txt = document.getElementById('encResult').innerText;
            if(!txt) return;
            
            if(navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(txt).then(updateCopyBtn).catch(function(){ fallbackCopy(txt); });
            } else {
                fallbackCopy(txt);
            }
        }

        function fallbackCopy(text) {
            var textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                updateCopyBtn();
            } catch (err) {
                showToast("COPY FAILED", true);
            }
            document.body.removeChild(textArea);
        }

        function updateCopyBtn() {
            var btn = document.getElementById('copyBtn');
            var oldHtml = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-check"></i> COPIED!';
            btn.classList.add('bg-green-600', 'text-black');
            btn.classList.remove('text-green-400');
            
            setTimeout(function() {
                btn.innerHTML = oldHtml;
                btn.classList.remove('bg-green-600', 'text-black');
                btn.classList.add('text-green-400');
            }, 2000);
        }

        // Crypto Setup
        var BASE64_CHARS = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
        var EMOJI_MAP = [
            'ğŸ˜€','ğŸ˜ƒ','ğŸ˜„','ğŸ˜','ğŸ˜†','ğŸ˜…','ğŸ¤£','ğŸ˜‚','ğŸ™‚','ğŸ™ƒ', 'ğŸ˜‰','ğŸ˜Š','ğŸ˜‡','ğŸ¥°','ğŸ˜','ğŸ¤©','ğŸ˜˜','ğŸ˜—','â˜ºï¸','ğŸ˜š',
            'ğŸ˜™','ğŸ¥²','ğŸ˜‹','ğŸ˜›','ğŸ˜œ','ğŸ¤ª','ğŸ˜','ğŸ¤‘','ğŸ¤—','ğŸ¤­', 'ğŸ¤«','ğŸ¤”','ğŸ¤','ğŸ¤¨','ğŸ˜','ğŸ˜‘','ğŸ˜¶','ğŸ˜','ğŸ˜’','ğŸ™„',
            'ğŸ˜¬','ğŸ¤¥','ğŸ˜Œ','ğŸ˜”','ğŸ˜ª','ğŸ¤¤','ğŸ˜´','ğŸ˜·','ğŸ¤’','ğŸ¤•', 'ğŸ¤¢','ğŸ¤®','ğŸ¤§','ğŸ¥µ','ğŸ¥¶','ğŸ¥´','ğŸ˜µ','ğŸ¤¯','ğŸ¤ ','ğŸ¥³',
            'ğŸ˜','ğŸ¤“','ğŸ§','ğŸ˜•','ğŸ˜Ÿ'
        ];

        function buf2b64(buf) {
            var binary = ''; var bytes = new Uint8Array(buf);
            for (var i = 0; i < bytes.byteLength; i++) binary += String.fromCharCode(bytes[i]);
            return window.btoa(binary);
        }

        function b642buf(b64) {
            var binary = window.atob(b64); var bytes = new Uint8Array(binary.length);
            for (var i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);
            return bytes.buffer;
        }

        function base64ToEmoji(b64) {
            var res = ''; for(var i=0; i<b64.length; i++) { var idx = BASE64_CHARS.indexOf(b64.charAt(i)); if(idx > -1) res += EMOJI_MAP[idx]; } return res;
        }

        function emojiToBase64(emojis) {
            var arr = Array.from(emojis); var res = ''; 
            for(var i=0; i<arr.length; i++) { var idx = EMOJI_MAP.indexOf(arr[i]); if(idx > -1) res += BASE64_CHARS[idx]; } return res;
        }

        async function getKey(pass, salt) {
            var enc = new TextEncoder();
            var keyMat = await crypto.subtle.importKey("raw", enc.encode(pass), {name:"PBKDF2"}, false, ["deriveKey"]);
            return crypto.subtle.deriveKey({ name:"PBKDF2", salt: salt, iterations:100000, hash:"SHA-256" }, keyMat, { name:"AES-GCM", length: 256 }, false, ["encrypt", "decrypt"]);
        }

        // Main Processes
        async function processEncrypt() {
            var msg = document.getElementById('encMsg').value;
            var pass = document.getElementById('encPass').value;
            if(!msg || !pass) return showToast("MISSING INPUT", true);
            
            if(!localStorage.getItem('site_key')) { localStorage.setItem('site_key', pass); applyKey(pass); }

            try {
                var salt = crypto.getRandomValues(new Uint8Array(16));
                var iv = crypto.getRandomValues(new Uint8Array(12));
                var key = await getKey(pass, salt);
                var enc = new TextEncoder();
                var encrypted = await crypto.subtle.encrypt({ name:"AES-GCM", iv: iv }, key, enc.encode(msg));
                var combined = new Uint8Array(salt.length + iv.length + encrypted.byteLength);
                combined.set(salt, 0); combined.set(iv, 16); combined.set(new Uint8Array(encrypted), 28);
                
                var finalStr = base64ToEmoji(buf2b64(combined.buffer));
                document.getElementById('encOutputBox').classList.remove('hidden');
                document.getElementById('encResult').innerText = finalStr;
                manualCopy();
            } catch(e) { showToast("ERROR", true); }
        }

        async function processDecrypt() {
            var emojiStr = document.getElementById('decInput').value.trim();
            var pass = document.getElementById('decPass').value;
            if(!emojiStr) return showToast("NO EMOJIS", true);
            if(!pass) return showToast("NO PASSWORD", true);

            try {
                var b64 = emojiToBase64(emojiStr);
                var arr = new Uint8Array(b642buf(b64));
                if(arr.length < 28) throw new Error("BAD DATA");
                
                var salt = arr.slice(0, 16); var iv = arr.slice(16, 28); var data = arr.slice(28);
                var key = await getKey(pass, salt);
                var decrypted = await crypto.subtle.decrypt({ name:"AES-GCM", iv: iv }, key, data);
                
                if(!localStorage.getItem('site_key')) { localStorage.setItem('site_key', pass); applyKey(pass); }

                document.getElementById('decResultBox').classList.remove('hidden');
                document.getElementById('decText').innerText = new TextDecoder().decode(decrypted);
                showToast("DECRYPTED SUCCESS!");
            } catch(e) { showToast("WRONG PASSWORD", true); }
        }

        // Settings / UI
        window.addEventListener('DOMContentLoaded', function() {
            var savedKey = localStorage.getItem('site_key'); if(savedKey) applyKey(savedKey);
        });

        function applyKey(key) {
            document.getElementById('encPass').value = key;
            document.getElementById('decPass').value = key;
            document.getElementById('setting-key').value = key;
            var s = document.getElementById('key-status');
            s.innerText = "KEY SAVED"; s.className = "text-[10px] text-green-500 font-bold";
        }

        function saveDefaultKey() {
            var val = document.getElementById('setting-key').value;
            if(val) { localStorage.setItem('site_key', val); applyKey(val); showToast("KEY SAVED!"); toggleSettings(); }
            else showToast("KEY EMPTY", true);
        }

        function clearData() {
            localStorage.removeItem('site_key');
            document.getElementById('encPass').value = ""; document.getElementById('decPass').value = ""; document.getElementById('setting-key').value = "";
            var s = document.getElementById('key-status'); s.innerText = "NOT SAVED"; s.className = "text-[10px] text-gray-500 font-bold";
            showToast("CLEARED!"); toggleSettings();
        }

        function toggleSettings() {
            var m = document.getElementById('settings-modal');
            m.classList.toggle('hidden');
        }

        function setMode(mode) {
            document.getElementById('view-encrypt').classList.add('hidden');
            document.getElementById('view-decrypt').classList.add('hidden');
            document.getElementById('tab-enc').classList.remove('active');
            document.getElementById('tab-dec').classList.remove('active');
            if(mode === 'encrypt') {
                document.getElementById('view-encrypt').classList.remove('hidden');
                document.getElementById('tab-enc').classList.add('active');
            } else {
                document.getElementById('view-decrypt').classList.remove('hidden');
                document.getElementById('tab-dec').classList.add('active');
            }
        }

        function showToast(msg, isError) {
            var t = document.getElementById('toast');
            document.getElementById('toastMsg').innerText = msg;
            t.style.borderColor = isError ? '#ef4444' : '#00f3ff';
            t.querySelector('i').className = isError ? 'fa-solid fa-triangle-exclamation text-red-500' : 'fa-solid fa-circle-check text-cyan-400';
            t.classList.remove('opacity-0');
            setTimeout(function() { t.classList.add('opacity-0'); }, 2000);
        }
    </script>
</body>
</html>


